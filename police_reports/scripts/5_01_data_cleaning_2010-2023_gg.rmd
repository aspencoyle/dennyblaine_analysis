---
title: "data_cleaning"
author: "Aspen Coyle"
date: "2024-05-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Info

This script cleans and organizes police data on reports from Golden Gardens Beach, with the goal of examining police response frequency over time

#### Load libraries, and install if necessary

```{r}
# Add all required libraries here
list.of.packages <- c("tidyverse", "lubridate")
# Get names of all required packages that aren't installed
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[, "Package"])]
# Install all new packages
if(length(new.packages)) install.packages(new.packages)


# Load all required libraries
lapply(list.of.packages, FUN = function(X) {
  do.call("require", list(X))
})

```


# Download data, remove unnecessary columns

Data was downloaded from the SPD public call data page, available at https://data.seattle.gov/Public-Safety/Call-Data/33kz-ixgy

Downloaded all available data from East precinct, Charlie sector on 2024-05-18


```{r}
# Read in data
gg_call_dat <- read.csv("../data/gg_call_data_2010-2023.csv")

# Woof, 237,000 rows! 

# Let's narrow it down some, and only select those calls with a blurred lat/long within a quarter mile of Golden Gardens Beach
# North boundary: 47.701264
# South boundary: 47.683033
# East boundary: -122.394518
# West boundary: -122.411624

# Filter by location
gg_call_dat <- gg_call_dat %>%
  dplyr::filter(Blurred_Latitude < 47.701264 & Blurred_Latitude > 47.683033) %>%    # north/south
  dplyr::filter(Blurred_Longitude < -122.394518 & Blurred_Longitude > -122.411624)  # east/west 


# Dropping unnecessary columns
# Precinct: all are East, safe to drop
# Sector: all are Charlie, safe to drop
# Beat: let's check
table(gg_call_dat$Beat)
# Some are C2, others C3. Regardless, safe to drop

# Can also drop Arrived Time (as non-arrived calls are blank, and we care about the time of the event

gg_call_dat <- gg_call_dat %>%
  select(-c("Precinct", "Sector", "Beat", "Arrived.Time"))
```

# Explore and clean data

```{r}
# A small thing I noticed, there's a fair amount of untidy data, especially in the Final.Call.Type column.
# Using untidy data, SPD! For shame!!! 
# Let's clean that up a touch so R doesn't stumble
gg_call_dat$Final.Call.Type <- str_remove(gg_call_dat$Final.Call.Type, "--")


# Look at different reasons calls were made
table(gg_call_dat$Initial.Call.Type)

# Alright, lots of these are non-applicable to any disorder or misconduct at Denny-Blaine.
# Let's remove all such non-applicable entries

# Remove rows with the following response types.
# This uses the same set as DB and Madison Beach, with the exception of decisions that were made by manual examination.

gg_call_dat <- gg_call_dat %>%
  filter(Initial.Call.Type != "-ASSIGNED DUTY - FOOT BEAT (FROM ASSIGNED CAR)") %>%    # patrol
  filter(Initial.Call.Type != "ALARM - COMM, HOLD-UP/PANIC (EXCEPT BANKS)") %>%        # burglary
  filter(Initial.Call.Type != "ALARM - COMM, SILENT/AUD BURG (INCL BANKS)") %>%        # burglary
  filter(Initial.Call.Type != "ALARM - RESIDENTIAL - BURGLARY, SILENT/AUDIBLE") %>%    # burglary
  filter(Initial.Call.Type != "ALARM - RESIDENTIAL - SILENT/AUD PANIC/DURESS") %>%     # burglary
  filter(Initial.Call.Type != "ASLT - DV CRITICAL") %>%                                # domestic violence
  filter(Initial.Call.Type != "ASSIST OTHER AGENCY - ROUTINE SERVICE") %>%             # assist other agency
  filter(Initial.Call.Type != "ASSIST PUBLIC - NO WELFARE CHK OR DV ORDER SERVICE") %>%# assist public
  filter(Initial.Call.Type != "ASSIST SPD") %>%                                        # assist SPD
  filter(Initial.Call.Type != "AUTO RECOVERY") %>%                                     # auto recovery
  filter(Initial.Call.Type != "BURG - COMM BURGLARY") %>%                              # burglary
  filter(Initial.Call.Type != "BURG - OCCUPIED RESD") %>%                              # burglary
  filter(Initial.Call.Type != "BURG - RESD (INCL UNOCC STRUCTURES ON PROP)") %>%       # burglary
  filter(Initial.Call.Type != "CHILD - ABAND, ABUSE, MOLEST, NEGLECT") %>%             # child abuse
  filter(Initial.Call.Type != "CHILD - CRITICAL ABAND, ABUSE, MOLEST, NEGLECT") %>%    # child abuse
  filter(Initial.Call.Type != "DISTURBANCE - DV - NO ASLT") %>%                        # domestic violence
  filter(Initial.Call.Type != "DISTURBANCE - DV CRITICAL") %>%                         # domestic violence
  filter(Initial.Call.Type != "DOWN - CHECK FOR DOWN PERSON") %>%                      # welfare check
  filter(Initial.Call.Type != "DUI - DRIVING UNDER INFLUENCE") %>%                     # DUI
  filter(Initial.Call.Type != "FOLLOW UP") %>%                                         # follow up
  filter(Initial.Call.Type != "FOUND PERSON") %>%                                      # found person
  filter(Initial.Call.Type != "FRAUD") %>%                                             # fraud
  filter(Initial.Call.Type != "HARBOR - WATER DEBRIS, NAVIGATIONAL HAZARDS") %>%       # water hazard
  filter(Initial.Call.Type != "HARBOR - WATER EMERGENCIES") %>%                        # water emergencies
  filter(Initial.Call.Type != "HARBOR - WATER NON-EMERGENCIES") %>%                    # water non-emergencies
  filter(Initial.Call.Type != "INFORMATIONAL BROADCASTS") %>%                          # informational broadcasts
  filter(Initial.Call.Type != "JUVENILE - RUNAWAY") %>%                                # juvenile runaway
  filter(Initial.Call.Type != "JUVENILE - RUNAWAY PICKUP") %>%                         # runaway found
  filter(Initial.Call.Type != "MISSING - ADULT") %>%                                   # adult missing
  filter(Initial.Call.Type != "MISSING - CHILD") %>%                                   # child missing
  filter(Initial.Call.Type != "MVC - HIT AND RUN") %>%                                 # motor vehicle collision
  filter(Initial.Call.Type != "OBS - ACC - WITH INJURIES (INCLUDES HIT AND RUN)") %>%  # motor vehicle collision
  filter(Initial.Call.Type != "OBS - BURG - IP/JO - COMM BURG (INCLUDES SCHOOLS)") %>% # burglary
  filter(Initial.Call.Type != "OBS - DOWN - CHECK FOR PERSON DOWN") %>%                # welfare check
  filter(Initial.Call.Type != "OBS - HIT AND RUN (NO INJURIES). INCLUDES IP/JO") %>%   # motor vehicle collision
  filter(Initial.Call.Type != "OBS - INJURED - IP/JO - PERSON/INDUSTRIAL ACCIDENT") %>%# accident
  filter(Initial.Call.Type != "OBS - MVC - NON INJURY, BLOCKING") %>%                  # motor vehicle collision
  filter(Initial.Call.Type != "OBS - MVC - UNK INJURIES") %>%                          # motor vehicle collision
  filter(Initial.Call.Type != "OBS - MVC - WITH INJURIES (INCLUDES HIT AND RUN)") %>%  # motor vehicle collision
  filter(Initial.Call.Type != "OBS - REPORT, NON INJ/NON BLKG OR AFTER FACT INJ") %>%  # motor vehicle collision
  filter(Initial.Call.Type != "OBS - SECONDARY - FORGERY/BUNCO/SCAMS/ID THEFT") %>%    # fraud
  filter(Initial.Call.Type != "OBS - TRU - ACC - HIT AND RUN") %>%                     # motor vehicle collision
  filter(Initial.Call.Type != "OPEN - BUILDING, DOOR, ETC.") %>%                       # open building
  filter(Initial.Call.Type != "ORDER - CRITICAL VIOLATION OF DV COURT ORDER") %>%      # court order violation
  filter(Initial.Call.Type != "ORDER - VIOLATING DV COURT ORDER") %>%                  # court order violation
  filter(Initial.Call.Type != "ORDER - VIOLATION OF COURT ORDER (NON DV)") %>%         # court order violation
  filter(Initial.Call.Type != "ORDER  - SERVICE OF DV COURT ORDER") %>%                # service of court order
  filter(Initial.Call.Type != "POWER OUT - POLES AND TRANSFORMERS") %>%                # power outage
  filter(Initial.Call.Type != "PREDICTIVE POLICING") %>%                               # predictive policing
  filter(Initial.Call.Type != "PROPERTY - FOUND") %>%                                  # found property
  filter(Initial.Call.Type != "PROPERTY - FOUND GUN, SHELLCASINGS") %>%                # found property
  filter(Initial.Call.Type != "SERVICE - WELFARE CHECK") %>%                           # welfare check
  filter(Initial.Call.Type != "SFD - ASSIST ON CRITICAL FIRE OR MEDIC RESPONSE") %>%   # assisting fire or medics
  filter(Initial.Call.Type != "SUICIDE - CRITICAL") %>%                                # suicide
  filter(Initial.Call.Type != "SUICIDE - SUICIDAL PERSON AND ATTEMPTS") %>%            # suicide
  filter(Initial.Call.Type != "THEFT OF SERVICES") %>%                                 # theft of services
  filter(Initial.Call.Type != "TRAF - ELUDING POLICE") %>%                             # eluding police
  filter(Initial.Call.Type != "TRAFFIC - ASSIST MOTORIST") %>%                         # assisting motorist
  filter(Initial.Call.Type != "TRAFFIC - BO SIGNALS AND DOWN SIGNS") %>%               # traffic signals down
  filter(Initial.Call.Type != "TRAFFIC - MOVING VIOLATION") %>%                        # moving violation
  filter(Initial.Call.Type != "TRAFFIC - ROAD RAGE") %>%                               # road rage
  filter(Initial.Call.Type != "TRAFFIC STOP - OFFICER INITIATED ONVIEW") %>%           # traffic stop
  filter(Initial.Call.Type != "TREES DOWN, OBSTRUCTING PUBLIC PROP (NO HAZ)") %>%      # downed trees
  filter(Initial.Call.Type != "TRU - FOLLOW UP") %>%                                   # follow up
  filter(Initial.Call.Type != "TRU - FRAUD") %>%                                       # fraud
  filter(Initial.Call.Type != "TRU - MVC - HIT AND RUN") %>%                           # motor vehicle collision
  filter(Initial.Call.Type != "WATER FLOODS (BROKEN MAINS/HYDRANTS, NO HAZ)")          # water floods

# Now do the same with all call types from Madison Beach

gg_call_dat <- gg_call_dat %>%
  filter(Initial.Call.Type != "ABANDONED VEHICLE") %>%                                 # abandoned vehicle
  filter(Initial.Call.Type != "ALARM - ATM MACHINE, FREE STANDING") %>%                # ATM alarm
  filter(Initial.Call.Type != "ALARM - BANK (HOLD-UP)") %>%                            # bank hold-up
  filter(Initial.Call.Type != "ALARM - EQUIPMENT") %>%                                 # alarm
  filter(Initial.Call.Type != "ALARM - TRACKING ALARM") %>%                            # alarm
  filter(Initial.Call.Type != "ASLT - DV") %>%                                         # domestic violence
  filter(Initial.Call.Type != "BOMB - THREATS") %>%                                    # bomb threat
  filter(Initial.Call.Type != "CHILD -  LURING") %>%                                   # child abuse
  filter(Initial.Call.Type != "CUSTODIAL INTERFERENCE - DV") %>%                       # domestic violence
  filter(Initial.Call.Type != "DEMONSTRATIONS") %>%                                    # demonstrations
  filter(Initial.Call.Type != "DIRECTED PATROL ACTIVITY") %>%                          # patrol
  filter(Initial.Call.Type != "HELP THE OFFICER") %>%                                  # help officer
  filter(Initial.Call.Type != "ILLEGAL DUMPING") %>%                                   # illegal dum[ing]
  filter(Initial.Call.Type != "LICENSE INSPECTIONS (CHECK FOR)") %>%                   # license inspection
  filter(Initial.Call.Type != "LIQUOR VIOLATIONS - BUSINESS") %>%                      # liquor viol for business
  filter(Initial.Call.Type != "MISSING - (ALZHEIMER, ENDANGERED, ELDERLY)") %>%        # missing person
  filter(Initial.Call.Type != "OBS - SICK PERSON") %>%                                 # sick person
  filter(Initial.Call.Type != "OBS - SLEEPER ABOARD BUS/COMMUTER TRAIN") %>%           # sleeping on bus
  filter(Initial.Call.Type != "OBS - SUSPICIOUS PACKAGE") %>%                          # suspicious package
  filter(Initial.Call.Type != "PANHANDLING, AGGRESSIVE") %>%                           # panhandling
  filter(Initial.Call.Type != "PREMISE CHECK, OFFICER INITIATED ONVIEW ONLY") %>%      # premise checks
  filter(Initial.Call.Type != "REQUEST TO WATCH ") %>%                                 # premise checks
  filter(Initial.Call.Type != "SHOPLIFT - THEFT") %>%                                  # shoplifting
  filter(Initial.Call.Type != "THREATS - DV - NO ASSAULT") %>%                         # domestic violence
  filter(Initial.Call.Type != "TRU - COMMERCIAL BURGLARY") %>%                         # burglary
  filter(Initial.Call.Type != "TRU - OBSCENE OR NUISANCE PHONE CALLS") %>%             # phone calls
  filter(Initial.Call.Type != "TRU - RESIDENTIAL BURGLARY") %>%                        # burglary
  filter(Initial.Call.Type != "TRU - ROAD RAGE") %>%                                   # road rage
  filter(Initial.Call.Type != "TRU - SHOPLIFT") %>%                                    # shoplift
  filter(Initial.Call.Type != "WARRANT - FELONY PICKUP") %>%                           # warrant
  filter(Initial.Call.Type != "WARRANT - MISD PICKUP") %>%                             # misdemeanor
  filter(Initial.Call.Type != "WARRANT - SEARCH. EXECUTED, SECURED") %>%               # warrant
  filter(Initial.Call.Type != "WIRES DOWN (PHONE, ELECTRICAL,ETC.)")                   # wires down

# There were no types at Madrona Beach that didn't require manual examination and weren't cover above. So that takes care of every incident type that had a match already! Let's examine the dataframe again for incident types only present at Golden Gardens Beach, and filter out if they're not potentially park-related
table(gg_call_dat$Initial.Call.Type)

gg_call_dat <- gg_call_dat %>%
  filter(Initial.Call.Type != "FOOT - ELUDING POLICE") %>%                            # someone eluding police who ran into park
  filter(Initial.Call.Type != "INFRASTRUCTURE CHECKS") %>%                            # infrastructure check
  filter(Initial.Call.Type != "ORDER - ASSIST DV VIC W/SRVC OF COURT ORDER") %>%      # domestic violence
  filter(Initial.Call.Type != "PHONE - OBSCENE OR NUISANCE PHONE CALLS") %>%          # phone calls
  filter(Initial.Call.Type != "SEX OFFENDER - FAILURE TO REGISTER")                   # unregistered sex offender


# Alright, we've got some reports that could potentially have something vaguely to do with Golden Gardens Beach, at least according to the initial report! Let's look at the final call reports to see if we can rule anything out

table(gg_call_dat$Final.Call.Type)

# Remove ones that can't be Golden Gardens Park-related. Again, we'll start with the types seen at Denny-Blaine that can't be park-related
gg_call_dat <- gg_call_dat %>%
  filter(Final.Call.Type != "ALARM-COMM (INC BANK, ATM, SCHOOLS, BSN)") %>%              # burglary
  filter(Final.Call.Type != "ALARM-RESIDENTIAL BURG") %>%                                # burglary
  filter(Final.Call.Type != "ALARM-RESIDENTIAL PANIC OR DURESS") %>%                     # residential assistance
  filter(Final.Call.Type != "AUTOMOBILES - RECOVERY (THEFT)") %>%                        # recovered car
  filter(Final.Call.Type != "BURGLARY - RESIDENTIAL OCCUPIED") %>%                       # burglary
  filter(Final.Call.Type != "BURGLARY - RESIDENTIAL, UNOCCUPIED") %>%                    # burglary
  filter(Final.Call.Type != "BURGLARY - UNOCC STRUC ON RESN PROP") %>%                   # burglary
  filter(Final.Call.Type != "CASUALTY,NON-TRAF,NON-CRIM - NON-DRUG RELATED") %>%         # non-drug-related casualty
  filter(Final.Call.Type != "DIRECTED PATROL ACTIVITY") %>%                              # patrol
  filter(Final.Call.Type != "DISTURBANCE - NOISE RESIDENTIAL") %>%                       # residential noise
  filter(Final.Call.Type != "DV - ARGUMENTS, DISTURBANCE (NO ARREST)") %>%               # domestic violence
  filter(Final.Call.Type != "DV - DOMESTIC THREATS BY PHONE OR WRITING") %>%             # domestic violence
  filter(Final.Call.Type != "DV - DOMESTIC VIOL/ASLT (ARREST MANDATORY)") %>%            # domestic violence
  filter(Final.Call.Type != "FRAUD - FRAUD, INCLUDING BUNCO") %>%                        # fraud
  filter(Final.Call.Type != "HARBOR - WATER EMERGENCIES") %>%                            # water emergency
  filter(Final.Call.Type != "HAZARDS - HAZARDS") %>%                                     # general hazard
  filter(Final.Call.Type != "HELP THE OFFICER -ASSIST THE OFFICER (NON EMERG)") %>%      # assisting officer
  filter(Final.Call.Type != "OBS - DOA - CASUALTY, DEAD BODY") %>%                       # dead body
  filter(Final.Call.Type != "PERSON - RUNAWAY") %>%                                      # runaway
  filter(Final.Call.Type != "PREDICTIVE POLICING PATROL") %>%                            # predictive policing
  filter(Final.Call.Type != "PREMISE CHECK, OFFICER INITIATED ONVIEW ONLY") %>%          # premise check
  filter(Final.Call.Type != "PREMISE CHECKS - BUSINESS CHECK") %>%                       # premise check
  filter(Final.Call.Type != "PREMISE CHECKS - HOMELESS ENCAMPMENT") %>%                  # premise check
  filter(Final.Call.Type != "PREMISE CHECKS - REQUEST TO WATCH") %>%                     # premise check
  filter(Final.Call.Type != "SUSPICIOUS CIRCUM. - BUILDING (OPEN DOOR, ETC)") %>%        # building 
  filter(Final.Call.Type != "SUSPICIOUS CIRCUM. - SUSPICIOUS VEHICLE") %>%               # suspicious vehicle
  filter(Final.Call.Type != "THEFT - SHOPLIFT") %>%                                      # shoplifting
  filter(Final.Call.Type != "TRAFFIC - D.U.I") %>%                                       # DUI
  filter(Final.Call.Type != "TRAFFIC - MOVING VIOLATION") %>%                            # moving violation
  filter(Final.Call.Type != "TRAFFIC - MV COLLISION INVESTIGATION") %>%                  # motor vehicle collision
  filter(Final.Call.Type != "WARRANT SERVICES - MISDEMEANOR")                            # warrant services

# Repeating process, but with ones that were observed at Madison Beach but not DB
gg_call_dat <- gg_call_dat %>%
  filter(Final.Call.Type != "ALARM-COMM ROBB (BANK, PANIC, DURESS)") %>%                  # alarm         
  filter(Final.Call.Type != "ASSIST PUBLIC - 911 HANG UP, OPEN LINE") %>%                 # 911 hangup
  filter(Final.Call.Type != "ASSIST PUBLIC - NO WELFARE CHK OR DV ORDER SERVICE") %>%     # public assistance
  filter(Final.Call.Type != "AUTOMOBILES - ABANDONED CAR") %>%                            # abandoned car
  filter(Final.Call.Type != "BURGLARY - NON RESIDENTIAL/COMMERCIAL") %>%                  # burglary
  filter(Final.Call.Type != "DEMO MGMNT (CONTROL TACTICS USED)") %>%                      # demonstration
  filter(Final.Call.Type != "DV - ASSIST VICTIM BY COURT ORDER") %>%                      # domestic violence
  filter(Final.Call.Type != "DV - DOMESTIC VIOLENCE (ARREST DISCRETIONARY)") %>%          # domestic violence
  filter(Final.Call.Type != "DV - STANDBY TO ASSURE PEACE") %>%                           # domestic violence
  filter(Final.Call.Type != "DV -VULNERABLE ADULT, FINANCIAL EXPLOITATION") %>%           # domestic violence
  filter(Final.Call.Type != "DV -VULNERABLE ADULT, PHYSICAL ABUSE") %>%                   # domestic violence
  filter(Final.Call.Type != "FRAUD - FORGERY, BAD CHECKS") %>%                            # fraud
  filter(Final.Call.Type != "HARBOR - HARBOR CODE VIOLATION") %>%                         # harbor
  filter(Final.Call.Type != "HAZ - POTENTIAL THRT TO PHYS SAFETY") %>%                    # hazard
  filter(Final.Call.Type != "PREMISE CHECKS - CRIME PREVENTION") %>%                      # premise checks
  filter(Final.Call.Type != "PROPERTY - FOUND PROPERTY") %>%                              # found property
  filter(Final.Call.Type != "TRAFFIC - ASSIST MOTORIST") %>%                              # motorist assistance
  filter(Final.Call.Type != "TRAFFIC - BICYCLE VIOLATION") %>%                            # bicycle violation
  filter(Final.Call.Type != "TRAFFIC - D.U.I.") %>%                                       # DUI
  filter(Final.Call.Type != "UNKNOWN - COMPLAINT OF UNKNOWN NATURE") %>%                  # unknown
  filter(Final.Call.Type != "VICE - LIQUOR (BUSINESS ESTABLISHMENT)") %>%                 # liquor violation in business
  filter(Final.Call.Type != "WARRANT SERVICES - FELONY")                                  # serving warrant
 

# None were observed for Madrona Beach that weren't observed at the first two
# Let's repeat the process again, this time manually examining
# and removing any types that don't seem park-related
# This catches any types seen here and not at DB, Madison Beach, or Madrona Beach

table(gg_call_dat$Final.Call.Type)

gg_call_dat <- gg_call_dat %>%
  filter(Final.Call.Type != "ASSAULTS - TELEPHONE, WRITING") %>%                          # phone calls or written threats
  filter(Final.Call.Type != "CHILD - ABAND, ABUSE, MOLEST, NEGLECT") %>%                  # child abuse
  filter(Final.Call.Type != "CHILD - ABANDONED, ABUSED AND NEGLECTED ") %>%               # child abuse
  filter(Final.Call.Type != "DISTURBANCE - DV - NO ASLT") %>%                             # domestic violence
  filter(Final.Call.Type != "DV - SERVICE OF COURT ORDER ") %>%                           # serving court order
  filter(Final.Call.Type != "PROPERTY - FOUND PROPERTY (NON-SPD SIN)") %>%                # found property
  filter(Final.Call.Type != "SEX OFFENSES (NON-RAPE) - FAILURE TO REGISTER") %>%          # failure of sex offender to register
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%
  filter(Final.Call.Type != "") %>%

# Let's also do a quick check of event resolution

table(gg_call_dat$Event.Clearance.Description)

# Remove false reports
gg_call_dat <- gg_call_dat %>%
  filter(Final.Call.Type != "FALSE COMPLAINT/UNFOUNDED")

# Alright, 1300-odd rows. Let's go back through, this time removing combinations that don't work
# Again, we're starting with by removing all combinations present here that we decided to remove from Denny-Blaine

gg_call_dat <- gg_call_dat %>%
  filter(Initial.Call.Type != "DIRECTED PATROL ACTIVITY" | Final.Call.Type != "PREMISE CHECKS - CRIME PREVENTION") %>%                 # checking premises
  filter(Initial.Call.Type != "DISTURBANCE" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)") %>%                          # public assistance
  filter(Initial.Call.Type != "HAZ - POTENTIAL THRT TO PHYS SAFETY" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%      # assisting agency
  filter(Initial.Call.Type != "HAZ - POTENTIAL THRT TO PHYS SAFETY" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)") %>%  # public assistance
  filter(Initial.Call.Type != "PREMISE CHECK, OFFICER INITIATED ONVIEW ONLY" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%     # assisting agency
  filter(Initial.Call.Type != "PREMISE CHECK, OFFICER INITIATED ONVIEW ONLY" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)") %>% # assisting agency
  filter(Initial.Call.Type != "PREMISE CHECK, OFFICER INITIATED ONVIEW ONLY" | Final.Call.Type != "PREMISE CHECKS - CRIME PREVENTION") %>%     # premise checks
  filter(Initial.Call.Type != "REQUEST TO WATCH" | Final.Call.Type != "PREMISE CHECKS - CRIME PREVENTION") %>%                                 # premise checks
  filter(Initial.Call.Type != "SERVICE - WELFARE CHECK" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)") %>%                      # welfare check
  filter(Initial.Call.Type != "UNKNOWN - ANI/ALI - LANDLINE (INCLUDES OPEN LINE)" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%# assisting agency
  filter(Initial.Call.Type != "UNKNOWN - ANI/ALI - LANDLINE (INCLUDES OPEN LINE)" | Final.Call.Type != "ASSIST PUBLIC - 911 HANG UP, OPEN LINE") %>%  # 911 hangup
  filter(Initial.Call.Type != "UNKNOWN - ANI/ALI - LANDLINE (INCLUDES OPEN LINE)" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)") %>% # assisting public
  filter(Initial.Call.Type != "UNKNOWN - ANI/ALI - WRLS PHNS (INCL OPEN LINE)" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%   # assisting agency
  filter(Initial.Call.Type != "UNKNOWN - COMPLAINT OF UNKNOWN NATURE" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%            # assisting agency
  filter(Initial.Call.Type != "UNKNOWN - COMPLAINT OF UNKNOWN NATURE" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)")            # assisting public

# Moving onto combinations that were only seen at Madison Beach, not Denny-Blaine

gg_call_dat <- gg_call_dat %>%
  filter(Initial.Call.Type != "ASSIST OTHER AGENCY - EMERGENCY SERVICE" | Final.Call.Type != "ASSIST OTHER AGENCY - COUNTY AGENCY") %>%       # assisting agency
  filter(Initial.Call.Type != "OBS - DOA - CASUALTY, DEAD BODY" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%                 # dead body
  filter(Initial.Call.Type != "OBS - DOA - CASUALTY, DEAD BODY" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)")                 # dead body

# Manual check for combinations we can remove from Golden Gardens Beach
gg_call_dat <- gg_call_dat %>%
  filter(Initial.Call.Type != "HAZ - CRITICAL" | Final.Call.Type != "ASSIST OTHER AGENCY - CITY AGENCY") %>%                                          # assisting agency
  filter(Initial.Call.Type != "UNKNOWN - ANI/ALI - WRLS PHNS (INCL OPEN LINE)" | Final.Call.Type != "ASSIST PUBLIC - OTHER (NON-SPECIFIED)") %>%     # assisting agency
  filter(Initial.Call.Type != "UNKNOWN - COMPLAINT OF UNKNOWN NATURE" | Final.Call.Type != "ASSIST OTHER AGENCY - COUNTY AGENCY")                     # assisting agency
```

Cool, we've got a list of incidents that could have potentially been at Golden Gardens Beach

Let's sort these into a few neater categories (abbreviations in parentheses):
- Disturbance
- Drugs
- Lewd conduct (lewd)
- Property damage/theft (prop.dmg)
- Suspicious people (suspicious)
- Violence
# Organizing into broad categories

```{r}
# Add new column, fill with NAs
gg_call_dat$broad_category <- NA

# We'll do this in base R - sorry, I just prefer this way!

# do based on initial call type. This is potentially flawed, as assumes initial call was accurate representation of situation, which is often VERY not true. If anything, this dramatically errs on the high side
table(gg_call_dat$Initial.Call.Type)

# Start assigning
# Again, let's assign everything that was also seen and assigned a value at DB, Madrona Beach, or Madison Beach

gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ALARM - DURESS/PANIC,TAXI/CAR/PRSN - NOT DV"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ANIMAL - INJURED, DEAD HAZARD, OTHER"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASLT - CRITICAL (NO SHOOTINGS)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASLT - REPORT FOR PERSON SHOT OR SHOT AT"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASLT - WITH OR W/O WPNS (NO SHOOTINGS)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "AUTO - THEFT/LOSS OF PLATES"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "AUTO THEFT - VEH THEFT OR THEFT AND RECOVERY"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "BIAS"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "BURN - RECKLESS BURNING"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "DISTURBANCE"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "EXPLOSION"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "FIGHT - CRITICAL WITH WEAPONS"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "FIGHT - PHYSICAL (NO WEAPONS)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "FIREWORKS (NO HAZARD)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HARAS - NO BIAS OR THREATS"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ILLEGAL DUMPING"] <- "prop.dmg"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "LEWD -  (EXPOSING, FLASHING)"] <- "lewd"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "LIQUOR VIOLATIONS - ADULT"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "LIQUOR VIOLATIONS - MINOR"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "NARCOTICS - VIOLATIONS (LOITER, USE, SELL, NARS)"] <- "drug"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "NOISE - ANIMAL (INCLUDES BARKING DOGS)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "NOISE - GENERAL"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "NUISANCE"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - ANIMAL - IP/JO - BITE"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - ARSON - IP/JO"] <- "prop.dmg"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - EXPLOSION - IP/JO"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - FIGHT - IP - PHYSICAL (NO WEAPONS)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - FIGHT - VERBAL/ORAL (NO WEAPONS)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - MENTAL - PERSON OR PICKUP/TRANSPORT"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - NOISE - DISTURBANCE (PARTY, ETC)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - PROWLER"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - PROWLER - IP/JO"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - SECONDARY - PROPERTY DAMAGE/DESTRUCTION"] <- "prop.dmg"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - SECONDARY - THEFT"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS WEAPN-IP/JO-GUN,DEADLY WPN (NO THRT/ASLT/DIST)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OVERDOSE"] <- "drug"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PARKING VIOLATION (EXCEPT ABANDONED CAR)"] <- "traffic"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PARKS VIOLATIONS/CITES (INCLUDES EXCLUSIONS)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PERSON IN BEHAVIORAL/EMOTIONAL CRISIS"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PREMISE CHECK, OFFICER INITIATED ONVIEW ONLY"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PROPERTY - DAMAGE"] <- "prop.dmg"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PROPERTY - DAMAGE (GUN RELATED)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ROBBERY - CRITICAL (INCLUDES STRONG ARM)"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ROBBERY (INCL STRONG ARM)"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "SEX IN PUBLIC PLACE (INCL MASTURBATION)"] <- "lewd"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "SHOTS HEARD - DELAY"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "SHOTS HEARD - IN PROGRESS"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "SUSPICIOUS PERSON, VEHICLE, OR INCIDENT"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "SUSPICIOUS STOP - OFFICER INITIATED ONVIEW"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "THEFT (DOES NOT INCLUDE SHOPLIFT OR SVCS)"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "THREATS (INCLS IN-PERSON/BY PHONE/IN WRITING)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRAFFIC - BLOCKING ROADWAY"] <- "traffic"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRESPASS"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - ASLT - MOLESTED ADULT (GROPED, FONDLED, ETC)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - DISTURBANCE"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - HARASSMENT"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - PROPERTY DESTRUCTION/DAMAGE"] <- "prop.dmg"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - SEX IN PUBLIC"] <- "lewd"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - SUSPICIOUS CIRCUMSTANCES"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - THEFT"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "UNKNOWN - ANI/ALI - LANDLINE (INCLUDES OPEN LINE)"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "UNKNOWN - COMPLAINT OF UNKNOWN NATURE"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "WEAPN - GUN,DEADLY WPN (NO THRTS/ASLT/DIST)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ALARM - AUDIBLE AUTOMOBILE (UNOCC/ANTI-THEFT)"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ALARM - DURESS/PANIC,BUS/TAXI/CAR/PRSN - NOT DV"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ANIMAL - DANGEROUS"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ANIMAL BITE"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ARSON - REPORT"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASLT - MOLESTED ADULT (GROPED, FONDLED, ETC.)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASLT - PERSON SHOT OR SHOT AT"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "LITTERING"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - ANIMAL - IP/JO - DANGEROUS"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - AUTO THEFT-IP/JO - VEHICLE, PLATES, TABS"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - PURSE SNATCH - IP/JO - ROBBERY"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "OBS - UNKNOWN - ANI/ALI - PAY PHN (INCL OPEN LINE)"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "PROPERTY - LOST OR MISSING"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "RAPE"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - ASLT - WITH OR W/O WPNS (NO SHOOTINGS)"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - AUTO THEFT"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - LEWD CONDUCT"] <- "lewd"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - PROPERTY, LOST OR MISSING"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "TRU - THREATS"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "URINATING, DEFECATING IN PUBLIC"] <- "lewd"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "DETOX - PICKUP (FIRE / POLICE STANDING BY)"] <- "drug"


# Alright, that's all the ones that can be easily defined
# Some can only be sorted by examining both initial and final call type
# Let's sort those now, using our assignments from DB, Madison Beach, and Madrona Beach
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASSIST OTHER AGENCY - EMERGENCY SERVICE" &
                                  gg_call_dat$Final.Call.Type == "AUTOMOBILES - AUTO THEFT"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "ASSIST OTHER AGENCY - EMERGENCY SERVICE" &
                                  gg_call_dat$Final.Call.Type == "DISTURBANCE - OTHER"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "ARSON,BOMBS,EXPLO - BOMBS, EXPLO,LARGE FIREWORKS"] <- "violence"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "DISTURBANCE - OTHER"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "MISCHIEF OR NUISANCE - GENERAL"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "PROWLER - TRESPASS"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "SUSPICIOUS CIRCUM. - SUSPICIOUS PERSON"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "THEFT - CAR PROWL"] <- "theft"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "UNKNOWN - ANI/ALI - WRLS PHNS (INCL OPEN LINE)" &
                                  gg_call_dat$Final.Call.Type == "SUSPICIOUS CIRCUM. - SUSPICIOUS PERSON"] <- "suspicious"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "UNKNOWN - ANI/ALI - WRLS PHNS (INCL OPEN LINE)" &
                                  gg_call_dat$Final.Call.Type == "DISTURBANCE - OTHER"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "HAZ - POTENTIAL THRT TO PHYS SAFETY" &
                                  gg_call_dat$Final.Call.Type == "CRISIS COMPLAINT - GENERAL"] <- "disturbance"
gg_call_dat$broad_category[gg_call_dat$Initial.Call.Type == "UNKNOWN - ANI/ALI - WRLS PHNS (INCL OPEN LINE)" &
                                  gg_call_dat$Final.Call.Type == "MISCHIEF OR NUISANCE - GENERAL"] <- "disturbance"


```

Nice, now we've got a slick clean (and TIDY, please take notes SPD!) dataframe. Now let's pull out the year from the date/time info!

```{r}
# Let's split the time/date string and just select the date
gg_call_dat$Original.Time.Queued <- str_split_i(gg_call_dat$Original.Time.Queued, " ", 1)

# Rename column
gg_call_dat <- gg_call_dat %>%
  rename(Incident.Date = Original.Time.Queued)

# Check column type
str(gg_call_dat$Incident.Date)
# Yep it's a character string

# Transform into Date object type
gg_call_dat$Incident.Date <- mdy(gg_call_dat$Incident.Date)
# Check it worked
str(gg_call_dat$Incident.Date)

# Write everything out
write.csv(gg_call_dat, file = "../output/potential_gg_calls_2010-2023.csv", row.names = FALSE)
```
Alright, next step: creating visualizations looking at trends by year!



